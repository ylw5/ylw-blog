# HTTP / 0.9
需求简单——在网络之间传递 HTML 超文本内容。
流程：
- 建立 TCP 连接
- 发送 GET 请求行信息，
- 服务器返回 HTML 文件（ASCII 字符流）
- 关闭 TCP 连接。
# HTTP/1.0
对应 HTTP/0.9 的功能扩展：
- 支持多种不同类型的数据：引入请求头和响应头

  :::details 请求头和响应头的详细信息
  请求头
  - accept：期待什么类型的文件
  - accept-encoding：可以采用什么压缩形式
  - accept-Charset: 需要什么编码方式
  - accept-language：需要什么语言

  响应头
  - content-encoding：返回的文件压缩形式
  - content-type：返回的文件类型和编码方式
  :::

  
HTTP 发送请求时带上请求头信息，服务器返回数据时先返回响应头。
- 服务器与客户端沟通：引入状态码
  :::details 状态码详细信息
  - 200：成功
  - 404：找不到资源
  - 500：服务器内部错误
  - //TODO
  :::
- 减轻服务器压力：引入Cache缓存机制

  // TODO
  - 强缓存：
  - 协商缓存：

# HTTP/1.1

对 HTTP/1.0 的性能优化：
- 增加持久连接：

  一个 TCP 连接可以传输多个 HTTP 请求，一直保持除非客户端或者服务器主动关闭连接。同一域名，默认允许 6 个 TCP 连接。
  
  会造成队头阻塞：一个 TCP 连接同一时刻只能处理一个请求，后面的要等前面的请求处理完。
- 不成熟的管线化：

  将多个 HTTP 请求整批提交给服务器。但是服务器仍然需要根据请求顺序来回复响应，所以没什么卵用。
- 增加 Host 头部字段：

  一个服务器可以提供多个网站（一 IP 多域名），通过 Host 字段来区分请求的网站。


功能拓展：
- 支持动态内容

  HTTP/1.0 中需要设置数据大小（Content-Length），HTTP/1.1 引入 Chunk transfer 机制，服务器分割数据并在发送时附上长度。

- Cookie机制和安全机制


- 使用CDN的实现域名分片机制：

  将一个页面的资源利用多个域名（CDN）下载，提高tcp并发数量。


缺陷：

- 带宽利用率不理想

  - TCP慢启动（为解决网络拥塞）

    每个域名维护一个持久连接

  - 多条TCP连接竞争固定带宽
  
    互相竞争带宽，不能协商让哪些关键资源优先下载

  - 队头阻塞（http/1.1机制）

    一个TCP管道同一时刻只能处理一个请求，且按顺序，需要排队。


  - TCP层的对头阻塞仍然存在。

    



# HTTP/2
对 HTTP/1.1 进行性能优化：

- 一个域名只使用一个 TCP 连接
 
  只需要一次慢启动，同时避免多个 TCP 连接的竞争。

- 多路复用

  协议栈中添加一个二进制分帧层

![img](https://static001.geekbang.org/resource/image/86/6a/86cdf01a3af7f4f755d28917e58aae6a.png?wh=1142*1156)




其他功能拓展：
- 可以设置请求优先级
- 服务器推送

  服务器可以主动推送资源到浏览器，不需要请求了，提高速度。
- 头部压缩

  浏览器发送的请求基本都是发送请求头，很少请求体。


缺点：TCP的队头阻塞仍然存在

在 TCP 传输过程中，由于单个数据包的丢失而造成的阻塞称为 TCP 上的队头阻塞。（丢包了整个TCP连接就会处于暂停状态）由于只有一个TCP连接，所以影响更深



TCP本身缺陷：

- 建立连接的延时（握手过程慢）
- 协议僵化，很难改进（中间设备僵化、基于操作系统内核）


# HTTP/3

QUIC协议
